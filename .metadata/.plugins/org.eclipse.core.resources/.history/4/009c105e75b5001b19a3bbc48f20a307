
#include "main.h"

void EXTI0_IRQHandler(void){
	// обработчик прерывания.
	// так как он работает на 5 пинов. нужно проверять откуда пришло нажание -- регистр PR
	if((EXTI -> PR & (EXTI_PR_PR0))){
		EXTI -> PR = (EXTI_PR_PR0); // сброс, чтоб не завит
	}



		return;
}

void SysClock_Init(void) {
	RCC->CR   |= RCC_CR_HSEON;
	RCC->CFGR |= RCC_CFGR_SW_HSE;
	while((RCC->CFGR & RCC_CFGR_SWS_Msk) != RCC_CFGR_SWS_HSE);
}

void Init_EXTI(void){
	RCC -> AHB1ENR |= RCC_AHB1ENR_GPIOAEN; // тактирование порта кнопки

	GPIO0->PUPDR |= (0x02 << (0 * 2));

	/*
	 * Button = PC13
	 */

	// Вывод МК должен быть настрое как вход.
	// На плате вывод резитором притянут на земле. Замыкание происходит на питание

	//EXTI -> RTSR |= EXTI_RTSR_TR13;	// Прерывание по нарастанию импульса
	EXTI -> FTSR |= EXTI_FTSR_TR0; // Прерывание по спаду импульса

	EXTI -> IMR |= EXTI_IMR_IM0; // Прерывание 13 включено

	//А что с это строкой???
	//ошибка(((

	NVIC_EnableIRQ(EXTI0_IRQn); // А где брать вот эти начальные названия???да, если для usart
	// а если для Timer?


 //  может в еррор лист что-то будет?
//	что там у тебя за страшные звуки)))? писк, скрипы))
//		нет
//		?да
//		да, имаче бы ккопка не работала

}

int main(void)
{
	SysClock_Init();
	Init_EXTI();
	while (1)
	{
		// что-то он туда постоянно попадает, хотя я ничего не нажимаю...
	}

}
